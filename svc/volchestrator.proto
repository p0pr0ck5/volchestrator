syntax = "proto3";

import "google/protobuf/timestamp.proto";

package volchestrator;

message HeartbeatMessage {
  string id = 1;
}

message HeartbeatResponse {
  string id = 1;
}

service Volchestrator {
  rpc Heartbeat(HeartbeatMessage) returns (HeartbeatResponse) {}
}

enum ClientStatus {
  UNKNOWN = 0;
  ALIVE = 1;
  DEAD = 2;
  LEFT = 3;
}

message ClientInfo {
  string id = 1;
  ClientStatus clientStatus = 2;
  google.protobuf.Timestamp firstSeen = 3;
  google.protobuf.Timestamp lastSeen = 4;
}

message ClientList {
  repeated ClientInfo info = 1;
}

message Empty {}

message VolumeID {
  string id = 1;
}

message Volume {
  string id = 1;
  repeated string tags = 2;
  string availabilityZone = 3;
}

message VolumeList {
  repeated Volume volumes = 1;
}

service VolchestratorAdmin {
  rpc ListClients(Empty) returns (ClientList) {}

  rpc GetVolume(VolumeID) returns (Volume) {}
  rpc ListVolumes(Empty) returns (VolumeList) {}
  rpc AddVolume(Volume) returns (Volume) {}
  rpc UpdateVolume(Volume) returns (Volume) {}
  rpc DeleteVolume(VolumeID) returns (Empty) {}
}